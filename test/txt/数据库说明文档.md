# ç§‘ç ”æˆæœç®¡ç†ç³»ç»Ÿ - æ•°æ®åº“è¯´æ˜æ–‡æ¡£

> æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2024-11-15  
> ç³»ç»Ÿç‰ˆæœ¬ï¼šv1.0

---

## ğŸ“š ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
2. [æ•°æ®åº“æ¶æ„](#2-æ•°æ®åº“æ¶æ„)
3. [æ ¸å¿ƒè¡¨ç»“æ„](#3-æ ¸å¿ƒè¡¨ç»“æ„)
4. [å…³ç³»å›¾](#4-å…³ç³»å›¾)
5. [ä½¿ç”¨æŒ‡å—](#5-ä½¿ç”¨æŒ‡å—)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| ä¸»æ•°æ®åº“ | PostgreSQL | ç»“æ„åŒ–æ•°æ®å­˜å‚¨ |
| å›¾æ•°æ®åº“ | Neo4j | çŸ¥è¯†å›¾è°± |
| æ–‡æ¡£æ•°æ®åº“ | MongoDB | éç»“æ„åŒ–æ•°æ® |
| ç¼“å­˜æ•°æ®åº“ | Redis | é«˜é€Ÿç¼“å­˜ |
| ORMæ¡†æ¶ | SQLAlchemy 2.0 (Async) | æ•°æ®åº“è®¿é—®å±‚ |

### 1.2 æ•°æ®åº“è¿æ¥

```yaml
PostgreSQL: postgresql+asyncpg://postgres:***@localhost:5432/research
Neo4j: bolt://localhost:7687
MongoDB: mongodb://localhost:27017/research
Redis: redis://localhost:6379/0
```

---

## 2. æ•°æ®åº“æ¶æ„

### 2.1 æ•°æ®åˆ†ç±»

```
ç§‘ç ”æˆæœç®¡ç†ç³»ç»Ÿ
â”œâ”€â”€ ğŸ“ æ ¸å¿ƒæˆæœ (7è¡¨)
â”‚   â”œâ”€â”€ papers (è®ºæ–‡)
â”‚   â”œâ”€â”€ patents (ä¸“åˆ©)
â”‚   â”œâ”€â”€ software_copyrights (è½¯è‘—)
â”‚   â”œâ”€â”€ projects (é¡¹ç›®)
â”‚   â”œâ”€â”€ competitions (ç«èµ›)
â”‚   â”œâ”€â”€ conferences (ä¼šè®®)
â”‚   â””â”€â”€ cooperations (åˆä½œ)
â”œâ”€â”€ ğŸ“¦ èµ„æºç®¡ç† (4è¡¨)
â”‚   â”œâ”€â”€ resources (èµ„æº)
â”‚   â”œâ”€â”€ resource_achievements (æˆæœå…³è”)
â”‚   â”œâ”€â”€ resource_usage_logs (ä½¿ç”¨æ—¥å¿—)
â”‚   â””â”€â”€ resource_maintenance_tasks (ç»´æŠ¤ä»»åŠ¡)
â”œâ”€â”€ ğŸ”— å…³ç³»ç®¡ç† (3è¡¨)
â”‚   â”œâ”€â”€ relationships (é€šç”¨å…³ç³»)
â”‚   â”œâ”€â”€ paper_authors (è®ºæ–‡ä½œè€…)
â”‚   â””â”€â”€ project_milestones (é¡¹ç›®é‡Œç¨‹ç¢‘)
â”œâ”€â”€ ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿ (2è¡¨)
â”‚   â”œâ”€â”€ tags (æ ‡ç­¾)
â”‚   â””â”€â”€ achievement_tags (æˆæœæ ‡ç­¾)
â”œâ”€â”€ ğŸ”” æé†’ç³»ç»Ÿ (1è¡¨)
â”‚   â””â”€â”€ reminders (æé†’)
â”œâ”€â”€ ğŸ” æœç´¢ç³»ç»Ÿ (1è¡¨)
â”‚   â””â”€â”€ search_saved_views (ä¿å­˜è§†å›¾)
â””â”€â”€ ğŸ‘¤ ç”¨æˆ·ç³»ç»Ÿ (1è¡¨)
    â””â”€â”€ users (ç”¨æˆ·)
```

**æ€»è®¡**: 19å¼ è¡¨

---

## 3. æ ¸å¿ƒè¡¨ç»“æ„

### 3.1 è®ºæ–‡è¡¨ (papers)

**ç”¨é€”**: å­¦æœ¯è®ºæ–‡å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `title` - è®ºæ–‡æ ‡é¢˜
- `journal` / `conference` - æœŸåˆŠ/ä¼šè®®
- `doi` - DOIæ ‡è¯†ç¬¦
- `impact_factor` - å½±å“å› å­
- `citation_count` - è¢«å¼•æ¬¡æ•°
- `writing_progress` - å†™ä½œè¿›åº¦(0-100)
- `status` - çŠ¶æ€: draft/submitted/accepted/published
- `keywords` - å…³é”®è¯æ•°ç»„
- `authors` - ä½œè€…ä¿¡æ¯(JSONB)

**ç‰¹ç‚¹**:
- æ”¯æŒæœŸåˆŠå’Œä¼šè®®ä¸¤ç§å‘è¡¨æ–¹å¼
- å®æ—¶è·Ÿè¸ªå½±å“å› å­å’Œå¼•ç”¨æ¬¡æ•°
- å†™ä½œè¿›åº¦å¯è§†åŒ–ç®¡ç†
- çµæ´»çš„JSONBå­—æ®µå­˜å‚¨æ‰©å±•ä¿¡æ¯

---

### 3.2 ä¸“åˆ©è¡¨ (patents)

**ç”¨é€”**: ä¸“åˆ©ç”³è¯·å’Œæˆæƒç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `name` - ä¸“åˆ©åç§°
- `patent_number` - ä¸“åˆ©å·
- `patent_type` - ç±»å‹: invention/utility/design
- `application_date` / `authorization_date` - ç”³è¯·/æˆæƒæ—¥æœŸ
- `commercialization_value` - å•†ä¸šåŒ–ä»·å€¼
- `maintenance_deadline` - ç»´æŠ¤æˆªæ­¢æ—¥æœŸ
- `inventors` - å‘æ˜äººä¿¡æ¯(JSONB)

**ç‰¹ç‚¹**:
- ä¸‰ç§ä¸“åˆ©ç±»å‹ç®¡ç†
- å•†ä¸šåŒ–ä»·å€¼è¯„ä¼°
- ç»´æŠ¤æœŸé™è‡ªåŠ¨æé†’
- å®Œæ•´ç”Ÿå‘½å‘¨æœŸè·Ÿè¸ª

---

### 3.3 é¡¹ç›®è¡¨ (projects)

**ç”¨é€”**: ç§‘ç ”é¡¹ç›®ç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `project_number` - é¡¹ç›®ç¼–å·
- `project_type` - ç±»å‹: national/provincial/enterprise
- `principal` - é¡¹ç›®è´Ÿè´£äºº
- `budget` / `budget_used` - é¢„ç®—/å·²ä½¿ç”¨
- `progress_percent` - è¿›åº¦ç™¾åˆ†æ¯”
- `priority` / `risk_level` - ä¼˜å…ˆçº§/é£é™©ç­‰çº§
- `status` - çŠ¶æ€: planning/ongoing/completed/suspended

**ç‰¹ç‚¹**:
- å¤šçº§é¡¹ç›®åˆ†ç±»
- é¢„ç®—è·Ÿè¸ªå’Œä½¿ç”¨åˆ†æ
- è¿›åº¦å¯è§†åŒ–
- é£é™©è¯„ä¼°å’Œä¼˜å…ˆçº§ç®¡ç†

---

### 3.4 è½¯ä»¶è‘—ä½œæƒè¡¨ (software_copyrights)

**ç”¨é€”**: è½¯ä»¶è‘—ä½œæƒç™»è®°ç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `registration_number` - ç™»è®°å·
- `version` - ç‰ˆæœ¬å·
- `development_language` - å¼€å‘è¯­è¨€
- `category` - è½¯ä»¶åˆ†ç±»
- `developers` - å¼€å‘è€…ä¿¡æ¯(JSONB)

---

### 3.5 ç«èµ›è¡¨ (competitions)

**ç”¨é€”**: å­¦ç§‘ç«èµ›ç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `level` - çº§åˆ«: international/national/provincial/school
- `award_level` - è·å¥–ç­‰çº§
- `team_members` - å›¢é˜Ÿæˆå‘˜(JSONB)
- `mentor` - æŒ‡å¯¼è€å¸ˆ

---

### 3.6 ä¼šè®®è¡¨ (conferences)

**ç”¨é€”**: å­¦æœ¯ä¼šè®®å‚ä¸ç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `participation_type` - å‚ä¸ç±»å‹: speaker/poster/attendee
- `travel_budget` / `travel_expense` - å·®æ—…é¢„ç®—/è´¹ç”¨
- `visa_required` - æ˜¯å¦éœ€è¦ç­¾è¯
- `participants` - å‚ä¼šäººå‘˜(JSONB)

---

### 3.7 åˆä½œè¡¨ (cooperations)

**ç”¨é€”**: æœºæ„åˆä½œCRMç®¡ç†

**æ ¸å¿ƒå­—æ®µ**:
- `organization` - åˆä½œæœºæ„
- `cooperation_type` - ç±»å‹: research/education/industry
- `cooperation_value` - åˆä½œä»·å€¼
- `pipeline_stage` - ç®¡é“é˜¶æ®µ
- `contact_person` / `contact_email` / `contact_phone` - è”ç³»äººä¿¡æ¯
- `next_follow_up` - ä¸‹æ¬¡è·Ÿè¿›æ—¥æœŸ

---

## 4. å…³ç³»å›¾

### 4.1 å®ä½“å…³ç³»

```
users â”€â”¬â”€â†’ papers
       â”œâ”€â†’ patents
       â”œâ”€â†’ projects â†’ project_milestones
       â”œâ”€â†’ software_copyrights
       â”œâ”€â†’ competitions
       â”œâ”€â†’ conferences
       â”œâ”€â†’ cooperations
       â”œâ”€â†’ resources â”€â”¬â”€â†’ resource_achievements
       â”‚              â”œâ”€â†’ resource_usage_logs
       â”‚              â””â”€â†’ resource_maintenance_tasks
       â””â”€â†’ reminders

papers â”€â†’ paper_authors â”€â†’ users

tags â”€â†’ achievement_tags â”€â†’ [ä»»æ„æˆæœ]

relationships: [ä»»æ„å®ä½“] â†â†’ [ä»»æ„å®ä½“]
```

### 4.2 å¸¸è§æŸ¥è¯¢æ¨¡å¼

**æŸ¥è¯¢ç”¨æˆ·çš„æ‰€æœ‰è®ºæ–‡**:
```sql
SELECT * FROM papers WHERE created_by = <user_id>;
```

**æŸ¥è¯¢é¡¹ç›®çš„æ‰€æœ‰é‡Œç¨‹ç¢‘**:
```sql
SELECT * FROM project_milestones WHERE project_id = <project_id>;
```

**æŸ¥è¯¢èµ„æºçš„ä½¿ç”¨ç»Ÿè®¡**:
```sql
SELECT COUNT(*), SUM(quantity) 
FROM resource_usage_logs 
WHERE resource_id = <resource_id>;
```

---

## 5. ä½¿ç”¨æŒ‡å—

### 5.1 é€šç”¨å­—æ®µè¯´æ˜

**æ‰€æœ‰è¡¨éƒ½åŒ…å«**:
- `id` (UUID) - ä¸»é”®
- `created_at` (DateTime) - åˆ›å»ºæ—¶é—´
- `updated_at` (DateTime) - æ›´æ–°æ—¶é—´

**å¤šæ•°è¡¨åŒ…å«**:
- `created_by` (UUID) - åˆ›å»ºäººID (å¤–é”®åˆ°users.id)
- `image_path` (String) - å›¾ç‰‡è·¯å¾„
- `file_path` (String) - æ–‡ä»¶è·¯å¾„

### 5.2 JSONBå­—æ®µä½¿ç”¨

**authorså­—æ®µç¤ºä¾‹**:
```json
[
  {
    "name": "å¼ ä¸‰",
    "affiliation": "XXå¤§å­¦",
    "is_corresponding": true
  }
]
```

**filterså­—æ®µç¤ºä¾‹** (search_saved_views):
```json
{
  "status": ["published", "accepted"],
  "date_range": {
    "start": "2024-01-01",
    "end": "2024-12-31"
  }
}
```

### 5.3 çŠ¶æ€å€¼è§„èŒƒ

| å®ä½“ | çŠ¶æ€å­—æ®µ | å¯é€‰å€¼ |
|------|---------|--------|
| è®ºæ–‡ | status | draft/submitted/accepted/published |
| ä¸“åˆ© | status | draft/pending/approved/rejected |
| é¡¹ç›® | status | planning/ongoing/completed/suspended |
| åˆä½œ | status | negotiating/active/completed/terminated |

### 5.4 æœ€ä½³å®è·µ

1. **ä½¿ç”¨UUIDè€Œéè‡ªå¢ID** - ä¾¿äºåˆ†å¸ƒå¼ç³»ç»Ÿå’Œæ•°æ®è¿ç§»
2. **å……åˆ†åˆ©ç”¨JSONB** - å­˜å‚¨çµæ´»çš„å…ƒæ•°æ®
3. **åˆç†ä½¿ç”¨ARRAYç±»å‹** - å­˜å‚¨å…³é”®è¯ã€æ ‡ç­¾ç­‰åˆ—è¡¨
4. **åˆ›å»ºé€‚å½“ç´¢å¼•** - æé«˜æŸ¥è¯¢æ€§èƒ½
5. **ä½¿ç”¨å¤–é”®çº¦æŸ** - ä¿è¯æ•°æ®å®Œæ•´æ€§

---

## é™„å½•

### A. æ•°æ®åº“è¿ç§»

ä½¿ç”¨Alembicè¿›è¡Œæ•°æ®åº“ç‰ˆæœ¬ç®¡ç†ï¼š
```bash
# åˆ›å»ºè¿ç§»
alembic revision --autogenerate -m "description"

# åº”ç”¨è¿ç§»
alembic upgrade head

# å›æ»š
alembic downgrade -1
```

### B. å¤‡ä»½å»ºè®®

```bash
# PostgreSQLå¤‡ä»½
pg_dump -U postgres research > backup.sql

# æ¢å¤
psql -U postgres research < backup.sql
```

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·åœ¨æ•°æ®åº“ç»“æ„å˜æ›´æ—¶åŠæ—¶æ›´æ–°æ­¤æ–‡æ¡£
