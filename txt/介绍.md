# 科研管理系统 (Research Management System)

> 基于 React + Tailwind CSS + FastAPI 的现代化科研成果管理平台

[![React](https://img.shields.io/badge/React-18.x-blue.svg)](https://reactjs.org/)
[![Next.js](https://img.shields.io/badge/Next.js-14.x-black.svg)](https://nextjs.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104-green.svg)](https://fastapi.tiangolo.com/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-blue.svg)](https://www.postgresql.org/)
[![MongoDB](https://img.shields.io/badge/MongoDB-6.0-green.svg)](https://www.mongodb.com/)

## 📋 目录

- [系统简介](#系统简介)
- [核心功能](#核心功能)
- [技术栈](#技术栈)
- [系统架构](#系统架构)
- [功能模块](#功能模块)
- [安全特性](#安全特性)
- [快速开始](#快速开始)
- [项目结构](#项目结构)
- [API文档](#api文档)
- [部署指南](#部署指南)
- [开发团队](#开发团队)

---

## 🎯 系统简介

科研管理系统是一个功能完善的科研成果管理平台，旨在帮助科研机构、高校和企业高效管理科研项目、论文、专利、软著等科研成果。系统采用前后端分离架构，提供现代化的用户界面和强大的数据管理能力。

### 核心优势

- ✅ **全面覆盖** - 支持9大科研成果类型管理
- ✅ **智能搜索** - MongoDB全文搜索 + AI智能分析
- ✅ **操作审计** - 完整的操作日志记录系统
- ✅ **权限控制** - 三级权限体系（用户/管理员/超级管理员）
- ✅ **批量操作** - CSV批量导入导出功能
- ✅ **现代UI** - 基于Shadcn/ui的美观界面
- ✅ **高性能** - 异步架构 + 分页加载
- ✅ **安全可靠** - JWT认证 + Token黑名单机制

---

## 🚀 核心功能

### 1. 科研成果管理

| 模块 | 功能 | 特性 |
|------|------|------|
| **论文管理** | 论文信息、作者、期刊、引用 | MongoDB全文搜索、PDF管理 |
| **项目管理** | 项目立项、进度、预算、里程碑 | 甘特图、预算分析 |
| **专利管理** | 专利申请、授权、维护 | 专利族管理、费用追踪 |
| **软著管理** | 软件著作权登记、维护 | 版本管理、开发者信息 |
| **会议管理** | 学术会议参与、论文投稿 | 差旅预算、签证提醒 |
| **合作管理** | 科研合作、资源共享 | 合作阶段、价值评估 |
| **竞赛管理** | 学科竞赛、获奖记录 | 团队管理、奖项追踪 |
| **资源管理** | 仪器设备、软件资源 | 使用记录、维护计划 |

### 2. 智能分析

- 📊 **AI报表生成** - 基于AI的数据分析和可视化报表
- 🔍 **全文搜索** - MongoDB支持的论文全文搜索
- 📈 **统计分析** - 多维度数据统计和趋势分析
- 🎯 **智能推荐** - 基于历史数据的智能推荐

### 3. 管理功能

- 👥 **用户管理** - 用户账户、权限、角色管理
- 📝 **操作审计** - 完整的操作日志记录和查询
- 📤 **批量导入** - CSV文件批量导入数据
- 📥 **数据导出** - Excel格式数据导出
- 🔔 **消息通知** - 系统消息和邮件通知

### 4. 安全认证

- 🔐 **JWT认证** - 基于Token的安全认证
- 📧 **邮箱验证码** - 支持验证码登录注册
- 🚫 **Token黑名单** - 登出后Token立即失效
- 🔒 **权限控制** - 细粒度的权限管理
- 📍 **IP追踪** - 记录所有登录IP地址

---

## 🛠️ 技术栈

### 前端技术

| 技术 | 版本 | 用途 |
|------|------|------|
| **Next.js** | 14.x | React框架 |
| **React** | 18.x | UI库 |
| **TypeScript** | 5.x | 类型系统 |
| **Tailwind CSS** | 3.x | CSS框架 |
| **Shadcn/ui** | Latest | UI组件库 |
| **Lucide Icons** | Latest | 图标库 |
| **React Query** | Latest | 数据获取 |
| **Recharts** | Latest | 图表库 |

### 后端技术

| 技术 | 版本 | 用途 |
|------|------|------|
| **FastAPI** | 0.104+ | Web框架 |
| **Python** | 3.11+ | 编程语言 |
| **SQLAlchemy** | 2.0+ | ORM |
| **Pydantic** | 2.0+ | 数据验证 |
| **Alembic** | Latest | 数据库迁移 |
| **Motor** | Latest | MongoDB异步驱动 |
| **PyJWT** | Latest | JWT认证 |
| **Passlib** | Latest | 密码加密 |

### 数据库

| 数据库 | 用途 |
|--------|------|
| **PostgreSQL 15** | 主数据库（结构化数据） |
| **MongoDB 6.0** | 文档存储（论文全文、AI报表、操作日志） |
| **Redis** | 缓存和会话管理 |

---

## 🏗️ 系统架构

### 架构图

```
┌─────────────────────────────────────────────────────────┐
│                      前端层 (Next.js)                     │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │ 用户界面 │  │ 管理界面 │  │ 日志管理 │  │ AI报表   │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘ │
└─────────────────────────────────────────────────────────┘
                           │ HTTP/REST API
┌─────────────────────────────────────────────────────────┐
│                     API层 (FastAPI)                       │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │ 认证授权 │  │ 业务逻辑 │  │ 数据验证 │  │ 日志记录 │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘ │
└─────────────────────────────────────────────────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
┌───────────────┐  ┌───────────────┐  ┌───────────────┐
│  PostgreSQL   │  │   MongoDB     │  │     Redis     │   |neo4j
│  (主数据库)    │  │ (文档/日志)    │  │   (缓存)      │   |知识图谱
└───────────────┘  └───────────────┘  └───────────────┘
```

### 数据流

```
用户操作 → 前端验证 → API请求 → 后端认证 
         → 业务逻辑 → 数据库操作 → 日志记录 
         → 返回结果 → 前端展示
```

---

## 📦 功能模块

### 模块1: 论文管理 (Papers)

**功能清单**:
- ✅ 论文CRUD操作
- ✅ 作者信息管理（JSON字段）
- ✅ 论文全文存储（MongoDB）
- ✅ 全文搜索功能
- ✅ 引用统计
- ✅ PDF文件管理
- ✅ 关键词标签
- ✅ 批量导入导出

**MongoDB应用**:
```javascript
// papers集合示例
{
  paper_id: "UUID",
  title: "论文标题",
  abstract: "摘要...",
  full_text: "完整论文内容...",  // 全文搜索
  keywords: ["AI", "机器学习"],
  created_at: ISODate()
}
```

### 模块2: 项目管理 (Projects)

**功能清单**:
- ✅ 项目立项、执行、结题
- ✅ 预算管理和分解
- ✅ 里程碑追踪
- ✅ 团队成员管理
- ✅ 关联论文和专利
- ✅ 进度可视化
- ✅ 外键级联删除

### 模块3: 专利管理 (Patents)

**功能清单**:
- ✅ 专利申请信息
- ✅ 发明人管理（JSON）
- ✅ 专利状态追踪
- ✅ 年费管理
- ✅ 专利族管理
- ✅ 技术领域分类

### 模块4: 用户管理 (Users)

**功能清单**:
- ✅ 用户注册登录
- ✅ 三级权限（user/admin/superadmin）
- ✅ 密码加密存储
- ✅ 邮箱验证码登录
- ✅ 用户信息修改
- ✅ 密码重置
- ✅ 账户禁用
- ✅ 操作日志记录

**权限体系**:
```
superadmin (超级管理员)
  ├─ 所有权限
  ├─ 用户管理
  ├─ 查看操作日志
  └─ 系统配置

admin (管理员)
  ├─ 数据管理权限
  ├─ 批量导入导出
  └─ 查看统计

user (普通用户)
  ├─ 查看数据
  └─ 基础操作
```

### 模块5-9: 其他科研成果

- **软著管理** - 软件著作权登记
- **会议管理** - 学术会议和差旅
- **合作管理** - 科研合作和资源共享
- **竞赛管理** - 学科竞赛和获奖
- **资源管理** - 仪器设备和软件资源

---

## 🔒 安全特性

### 1. 认证安全

```python
# JWT Token认证
- 基于HS256算法的JWT
- Token有效期30天
- 自动刷新机制
- Token黑名单（登出后立即失效）
```

### 2. 密码安全

```python
# Bcrypt加密
- 密码哈希存储
- 随机盐值
- 不可逆加密
- 支持密码强度验证
```

### 3. 操作审计

**完整的审计日志系统**:

| 记录内容 | 说明 |
|---------|------|
| 用户ID | 操作者 |
| 操作类型 | create/update/delete/login/register |
| 资源类型 | paper/project/patent/user等 |
| 资源ID | 具体记录ID |
| 数据变更 | before/after对比 |
| IP地址 | 操作来源IP |
| User-Agent | 设备和浏览器信息 |
| 时间戳 | 操作时间 |
| 状态 | success/failed |

**MongoDB日志示例**:
```javascript
{
  user_id: "操作者UUID",
  action: "update",
  resource_type: "paper",
  resource_id: "论文UUID",
  changes: {
    before: { status: "draft" },
    after: { status: "published" }
  },
  ip_address: "192.168.1.100",
  user_agent: "Mozilla/5.0...",
  status: "success",
  timestamp: ISODate("2024-11-16T10:00:00Z")
}
```

### 4. 权限控制

```python
# 依赖注入的权限检查
current_user: User = Depends(get_current_user)        # 任何登录用户
current_user: User = Depends(get_current_admin_user)  # 管理员
current_user: User = Depends(get_current_superadmin_user)  # 超级管理员
```

---

## 🚀 快速开始

### 环境要求

- Python 3.11+
- Node.js 18+
- PostgreSQL 15+
- MongoDB 6.0+
- Redis (可选)

### 后端启动

```bash
# 1. 进入后端目录
cd back

# 2. 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 3. 安装依赖
pip install -r requirements.txt

# 4. 配置环境变量
cp .env.example .env
# 编辑 .env 文件，配置数据库连接

# 5. 初始化数据库
alembic upgrade head

# 6. 启动服务
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 前端启动

```bash
# 1. 进入前端目录
cd front

# 2. 安装依赖
npm install

# 3. 配置环境变量
cp .env.example .env.local
# 编辑 .env.local 文件

# 4. 启动开发服务器
npm run dev
```

### 访问系统

- 前端地址: http://localhost:3000
- 后端API: http://localhost:8000
- API文档: http://localhost:8000/docs
- 数据库管理: http://localhost:8000/admin

### 默认账户

首个注册的用户自动成为**超级管理员**。

---

## 📂 项目结构

### 后端结构

```
back/
├── app/
│   ├── api/              # API路由
│   │   ├── routes/       # 各模块路由
│   │   └── deps.py       # 依赖注入
│   ├── core/             # 核心配置
│   │   ├── config.py     # 配置文件
│   │   └── security.py   # 安全相关
│   ├── crud/             # 数据库操作
│   ├── db/               # 数据库连接
│   │   ├── postgres.py   # PostgreSQL
│   │   └── mongodb.py    # MongoDB
│   ├── models/           # 数据模型
│   │   └── tables.py     # SQLAlchemy模型
│   ├── schemas/          # Pydantic模型
│   ├── services/         # 业务服务
│   │   ├── audit_log.py  # 审计日志
│   │   ├── email.py      # 邮件服务
│   │   └── ai_report.py  # AI报表
│   └── main.py           # 应用入口
├── alembic/              # 数据库迁移
├── tests/                # 测试文件
└── requirements.txt      # Python依赖
```

### 前端结构

```
front/
├── app/                  # Next.js页面
│   ├── (auth)/          # 认证页面
│   ├── (dashboard)/     # 仪表盘
│   │   ├── admin/       # 管理页面
│   │   └── [modules]/   # 各功能模块
│   └── layout.tsx       # 布局组件
├── components/          # React组件
│   ├── ui/              # UI组件(Shadcn)
│   └── [custom]/        # 自定义组件
├── contexts/            # React Context
│   └── auth-context.tsx # 认证上下文
├── hooks/               # 自定义Hooks
├── lib/                 # 工具库
│   └── api/             # API封装
├── public/              # 静态资源
└── styles/              # 样式文件
```

---

## 📚 API文档

### RESTful API设计

所有API遵循RESTful规范：

```
GET    /api/{resource}           # 获取列表
GET    /api/{resource}/{id}      # 获取详情
POST   /api/{resource}           # 创建
PUT    /api/{resource}/{id}      # 更新
DELETE /api/{resource}/{id}      # 删除
```

### 主要端点

| 模块 | 端点 | 认证 |
|------|------|------|
| 认证 | `/api/auth/*` | 部分需要 |
| 论文 | `/api/papers/*` | 需要 |
| 项目 | `/api/projects/*` | 需要 |
| 专利 | `/api/patents/*` | 需要 |
| 用户 | `/api/users/*` | 超级管理员 |
| 日志 | `/api/audit-logs/*` | 超级管理员 |
| AI报表 | `/api/ai-reports/*` | 需要 |

### 分页参数

```typescript
{
  page: number    // 页码，从1开始
  size: number    // 每页数量，默认10
  search?: string // 搜索关键词
  [filters]       // 其他筛选参数
}
```

### 响应格式

```json
{
  "items": [...],
  "total": 100,
  "page": 1,
  "size": 10,
  "pages": 10
}
```

---

## 🎨 UI特性

### 设计系统

- 🎨 **现代化设计** - 基于Shadcn/ui组件库
- 🌓 **深色模式** - 支持亮色/暗色主题切换
- 📱 **响应式** - 适配桌面、平板、手机
- ♿ **无障碍** - 遵循WCAG 2.1标准
- 🎭 **动画效果** - 流畅的过渡动画

### 组件库

- Button - 按钮组件
- Input - 输入框
- Select - 下拉选择
- Dialog - 对话框
- Table - 数据表格
- Card - 卡片容器
- Badge - 标签
- Alert - 提示框

---

## 📊 数据库设计

### PostgreSQL表结构

**核心表**:
- `users` - 用户表
- `papers` - 论文表
- `projects` - 项目表
- `patents` - 专利表
- `project_milestones` - 项目里程碑
- `software_copyrights` - 软著表
- `conferences` - 会议表
- `cooperations` - 合作表
- `competitions` - 竞赛表
- `resources` - 资源表

### MongoDB集合

**核心集合**:
- `papers` - 论文全文
- `ai_reports` - AI生成的报表
- `audit_logs` - 操作审计日志

### 数据关系

```
projects (1) ←→ (N) project_milestones
projects (N) ←→ (N) papers
projects (N) ←→ (N) patents
users (1) → (N) papers
users (1) → (N) projects
```

---

## 🔧 开发指南

### 添加新模块

1. **后端**
   ```python
   # 1. 创建模型 (models/tables.py)
   # 2. 创建Schema (schemas/)
   # 3. 创建CRUD (crud/)
   # 4. 创建路由 (api/routes/)
   # 5. 注册路由 (main.py)
   # 6. 添加日志记录
   ```

2. **前端**
   ```typescript
   // 1. 创建API封装 (lib/api/)
   // 2. 创建页面 (app/)
   // 3. 创建组件 (components/)
   // 4. 添加路由导航
   ```

### 代码规范

- Python: PEP 8
- TypeScript: ESLint + Prettier
- Git提交: Conventional Commits

---

## 🧪 测试

### 后端测试

```bash
# 运行所有测试
pytest

# 测试覆盖率
pytest --cov=app tests/
```

### 前端测试

```bash
# 单元测试
npm test

# E2E测试
npm run test:e2e
```

---

## 📈 性能优化

### 后端优化

- ✅ 异步数据库操作
- ✅ 连接池管理
- ✅ 查询优化（索引、联表）
- ✅ Redis缓存
- ✅ 分页加载

### 前端优化

- ✅ 代码分割
- ✅ 懒加载
- ✅ 图片优化
- ✅ CDN加速
- ✅ Service Worker

---

## 🚀 部署指南

### Docker部署

```bash
# 构建镜像
docker-compose build

# 启动服务
docker-compose up -d

# 查看日志
docker-compose logs -f
```

### 生产环境

1. **后端**: Uvicorn + Nginx + Supervisor
2. **前端**: Next.js + Nginx
3. **数据库**: PostgreSQL主从复制
4. **缓存**: Redis集群
5. **监控**: Prometheus + Grafana

---

## 📝 更新日志

### v1.0.0 (2024-11-16)

**核心功能**:
- ✅ 9大科研成果管理模块
- ✅ 用户认证和权限系统
- ✅ MongoDB审计日志系统
- ✅ 批量导入导出功能
- ✅ AI报表生成
- ✅ 全文搜索

**技术实现**:
- ✅ 前后端分离架构
- ✅ JWT + Token黑名单认证
- ✅ PostgreSQL + MongoDB双数据库
- ✅ 完整的CRUD + 日志记录
- ✅ 响应式UI设计

---

## 👥 开发团队

**项目负责人**: [Your Name]

**技术栈**:
- 后端: FastAPI + SQLAlchemy + Motor
- 前端: Next.js + React + Tailwind CSS
- 数据库: PostgreSQL + MongoDB

---

## 📄 许可证

本项目采用 MIT 许可证。

---

## 🙏 致谢

感谢以下开源项目:
- [FastAPI](https://fastapi.tiangolo.com/)
- [Next.js](https://nextjs.org/)
- [Shadcn/ui](https://ui.shadcn.com/)
- [PostgreSQL](https://www.postgresql.org/)
- [MongoDB](https://www.mongodb.com/)

---

## 📞 联系方式

- 项目主页: [GitHub Repository]
- 问题反馈: [Issues]
- 技术支持: [Email]

---

**🎉 感谢使用科研管理系统！**
