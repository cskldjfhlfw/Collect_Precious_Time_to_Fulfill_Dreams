# 科研成果管理系统 - 详细设计文档

## 1. 项目概述

### 1.1 项目背景
为科研小组设计一套完整的科研成果管理系统，旨在提升科研管理效能，实现科研成果的数字化、可视化和智能化管理。

### 1.2 核心目标
- 统一管理各类科研成果数据
- 提供直观的数据展示和搜索功能
- 通过知识图谱展示科研成果之间的关联关系
- 支持数据统计分析和可视化
- 提升科研团队协作效率

## 2. 需求分析

### 2.1 核心功能需求

#### 2.1.1 科研成果管理
系统需要管理以下类型的科研成果：

1. **论文（Paper）**
   - 基本信息：标题、作者、发表时间、期刊/会议名称、DOI、影响因子
   - 分类：期刊论文、会议论文、预印本
   - 状态：投稿中、已接收、已发表
   - 图片：封面图片或代表性图片
   - 附件：PDF文件、补充材料

2. **专利（Patent）**
   - 基本信息：专利名称、专利号、申请日期、授权日期、专利类型（发明/实用新型/外观设计）
   - 状态：申请中、已授权、已转让
   - 图片：专利示意图或代表性图片
   - 附件：专利申请书、授权证书

3. **软件著作权（Software Copyright）**
   - 基本信息：软件名称、登记号、登记日期、版本号
   - 状态：申请中、已登记
   - 图片：软件界面截图或Logo
   - 附件：登记证书、软件说明书

4. **项目（Project）**
   - 基本信息：项目名称、项目编号、项目类型（纵向/横向）、负责人、起止时间、经费
   - 状态：申报中、进行中、已结题
   - 图片：项目展示图片或架构图
   - 关联：关联的论文、专利等成果
   - 附件：项目申请书、结题报告

5. **比赛（Competition）**
   - 基本信息：比赛名称、级别（国家级/省级/校级）、获奖等级、获奖时间、团队成员
   - 状态：报名中、进行中、已获奖
   - 图片：比赛现场照片或作品展示图
   - 附件：获奖证书、作品材料

6. **会议（Conference）**
   - 基本信息：会议名称、会议级别、举办地点、举办时间、参与类型（参会/报告/组织）
   - 图片：会议现场照片或会议海报
   - 关联：关联的论文、项目
   - 附件：会议照片、报告PPT

7. **实战部门合作（Cooperation）**
   - 基本信息：合作单位、合作内容、合作时间、合作类型（技术咨询/联合研发/成果转化）
   - 状态：洽谈中、进行中、已完成
   - 图片：合作签约照片或合作成果展示图
   - 关联：关联的项目、专利等
   - 附件：合作协议、合作成果

#### 2.1.2 数据展示功能
- **仪表盘概览**：首页及各业务页面提供统计卡片、趋势图、进度条等即时指标
- **列表展示**：支持表格、卡片等多种展示方式
- **详情展示**：完整的成果信息展示页面
- **筛选功能**：按类型、时间、状态、人员等多维度筛选
- **排序功能**：按时间、重要性等排序
- **分页功能**：支持大数据量的分页加载
- **提醒与推荐**：提供待办提醒、智能推荐、提醒事项等辅助组件

#### 2.1.3 搜索功能
- **全文搜索**：支持标题、摘要、关键词等全文检索
- **高级搜索**：多条件组合搜索
- **模糊搜索**：支持模糊匹配
- **搜索历史**：记录用户搜索历史
- **搜索建议**：智能搜索建议

#### 2.1.4 知识图谱功能
- **实体识别**：自动识别论文、专利、项目、人员、机构、关键词等实体
- **关系抽取**：识别实体之间的关联关系（作者关系、引用关系、合作关系等）
- **图谱可视化**：交互式知识图谱展示
- **图谱搜索**：基于图谱的关联搜索
- **图谱分析**：中心度分析、社区发现等

#### 2.1.5 资源管理功能
- **资源类型**：数据集、工具软件、实验设备、标准规范、技术文档等
- **资源信息**：资源名称、类型、描述、版本、创建时间、维护者
- **资源展示**：资源列表、详情展示、图片展示
- **资源下载**：支持资源文件下载（权限控制）
- **资源关联**：关联相关的论文、项目等成果

### 2.2 补充功能需求

#### 2.2.1 用户权限管理
- **角色定义**：
  - 超级管理员：系统管理、用户管理
  - 管理员：数据管理、审核
  - 普通用户：数据录入、查看
  - 访客：仅查看
- **权限控制**：基于角色的访问控制（RBAC）
- **操作日志**：记录用户操作历史

#### 2.2.2 数据导入导出
- **批量导入**：支持Excel、CSV格式批量导入
- **数据导出**：支持导出为Excel、PDF、JSON等格式
- **模板下载**：提供标准导入模板
- **数据校验**：导入数据格式校验

#### 2.2.3 统计分析
- **数据概览**：成果数量统计、趋势分析
- **可视化图表**：柱状图、折线图、饼图、词云等
- **报表生成**：自动生成年度/季度报表
- **对比分析**：年度对比、人员对比等

#### 2.2.4 文件管理
- **文件上传**：支持多种文件格式上传
- **文件存储**：文件分类存储管理
- **文件预览**：在线预览PDF、图片等
- **文件下载**：权限控制的文件下载

#### 2.2.5 关联关系管理
- **成果关联**：建立成果之间的关联关系
- **人员关联**：建立人员与成果的关联
- **时间线展示**：按时间线展示成果发展历程

#### 2.2.6 标签与分类
- **标签系统**：支持自定义标签
- **分类管理**：多级分类体系
- **标签云**：可视化标签展示

#### 2.2.7 通知提醒
- **系统通知**：重要事件通知
- **邮件提醒**：关键节点邮件提醒
- **待办事项**：任务提醒功能

#### 2.2.8 数据备份与恢复
- **自动备份**：定期自动备份数据
- **手动备份**：支持手动备份
- **数据恢复**：支持数据恢复功能

#### 2.2.9 图片管理
- **图片上传**：支持多种图片格式（JPG、PNG、WebP等）
- **图片存储**：图片分类存储，支持缩略图生成
- **图片展示**：成果详情页图片展示，支持图片预览和放大
- **图片优化**：自动压缩和格式转换，提升加载速度

## 3. 技术架构设计

### 3.1 整体架构

```
┌─────────────────────────────────────────────────────────┐
│                     前端层 (Frontend)                     │
│  React + TypeScript + Tailwind CSS + Vite                │
│  - 展示页面、搜索界面、知识图谱可视化                      │
└─────────────────────────────────────────────────────────┘
                            ↕ HTTP/WebSocket
┌─────────────────────────────────────────────────────────┐
│                    API层 (Backend API)                    │
│  FastAPI + Python 3.9+                                  │
│  - RESTful API、WebSocket、认证授权                       │
└─────────────────────────────────────────────────────────┘
                            ↕
┌─────────────────────────────────────────────────────────┐
│                   业务逻辑层 (Business Logic)              │
│  - 数据管理、搜索服务、知识图谱构建、统计分析              │
└─────────────────────────────────────────────────────────┘
                            ↕
┌─────────────────────────────────────────────────────────┐
│                   数据存储层 (Data Storage)                │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐ │
│  │PostgreSQL│  │  Neo4j   │  │ MongoDB  │  │  Redis   │ │
│  │结构化数据│  │知识图谱  │  │文件元数据│  │缓存/会话 │ │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘ │
└─────────────────────────────────────────────────────────┘
                            ↕
┌─────────────────────────────────────────────────────────┐
│                   文件存储层 (File Storage)                │
│  本地文件系统 / 对象存储 (MinIO / AWS S3)                 │
└─────────────────────────────────────────────────────────┘
```

### 3.2 前端技术栈

#### 3.2.1 核心框架
- **React 19+**：UI框架
- **TypeScript 5.9+**：类型安全
- **Vite 7+**：构建工具，快速开发

#### 3.2.2 UI框架与样式
- **Tailwind CSS 3+**：原子化CSS框架
- **Headless UI / Radix UI**：无样式组件库
- **React Router**：路由管理
- **React Hook Form**：表单管理
- **Zod**：表单验证

#### 3.2.3 状态管理
- **Zustand / Jotai**：轻量级状态管理
- **React Query (TanStack Query)**：服务端状态管理、缓存

#### 3.2.4 数据可视化
- **D3.js**：知识图谱可视化
- **Cytoscape.js**：图可视化（备选）
- **Recharts / Chart.js**：统计图表
- **React Flow**：流程图/关系图（备选）

#### 3.2.5 其他工具库
- **Axios**：HTTP客户端
- **date-fns**：日期处理
- **react-table / TanStack Table**：表格组件
- **Framer Motion**：动画库
- **React PDF**：PDF预览

### 3.3 后端技术栈

#### 3.3.1 核心框架
- **FastAPI 0.104+**：现代Python Web框架
- **Python 3.11+**：编程语言
- **Pydantic 2+**：数据验证
- **Uvicorn**：ASGI服务器

#### 3.3.2 数据库驱动
- **SQLAlchemy 2.0+**：PostgreSQL ORM
- **asyncpg**：PostgreSQL异步驱动
- **Neo4j Python Driver**：Neo4j驱动
- **Motor**：MongoDB异步驱动
- **Redis-py / aioredis**：Redis客户端

#### 3.3.3 认证授权
- **JWT (python-jose)**：JWT令牌
- **Passlib + bcrypt**：密码加密
- **OAuth2**：OAuth2认证

#### 3.3.4 搜索功能
- **Elasticsearch**：全文搜索引擎（可选）
- **PostgreSQL Full-Text Search**：PostgreSQL全文搜索
- **Whoosh**：Python全文搜索库（轻量级备选）

#### 3.3.5 文件处理
- **Pillow**：图片处理（缩放、裁剪、格式转换）
- **PyPDF2 / pdfplumber**：PDF处理
- **python-multipart**：文件上传处理
- **python-magic**：文件类型检测

#### 3.3.6 其他工具
- **Celery**：异步任务队列（可选）
- **APScheduler**：定时任务
- **pandas**：数据分析
- **numpy**：数值计算

### 3.4 数据库设计

#### 3.4.1 PostgreSQL（主数据库）
存储所有结构化数据，包括：

**用户表 (users)**
```sql
- id: UUID (主键)
- username: VARCHAR(50) (唯一)
- email: VARCHAR(100) (唯一)
- password_hash: VARCHAR(255)
- role: VARCHAR(20) (admin/user/guest)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**论文表 (papers)**
```sql
- id: UUID (主键)
- title: VARCHAR(500)
- authors: JSONB (作者列表，保留便捷展示)
- journal: VARCHAR(200)
- conference: VARCHAR(200)
- publish_date: DATE
- doi: VARCHAR(100)
- impact_factor: DECIMAL(5,2)
- citation_count: INTEGER (引用次数，默认0)
- writing_progress: INTEGER (论文撰写进度百分比，0-100)
- status: VARCHAR(20) (撰写中/审稿中/已发表/撤稿等)
- abstract: TEXT
- keywords: TEXT[]
- related_projects: JSONB (可选，关联项目列表)
- image_path: VARCHAR(500) (封面图片路径)
- file_path: VARCHAR(500)
- created_by: UUID (外键 -> users)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

> 说明：为支持更精细的作者贡献统计，后续将引入 `paper_authors` 关联表，记录作者顺序、贡献度、单位等信息。

**专利表 (patents)**
```sql
- id: UUID (主键)
- name: VARCHAR(500)
- patent_number: VARCHAR(100)
- application_date: DATE
- authorization_date: DATE
- patent_type: VARCHAR(20) (发明/实用新型/外观设计)
- status: VARCHAR(20) (申请中/已授权/已转让/维护中)
- technology_field: VARCHAR(100) (技术领域)
- commercialization_value: DECIMAL(12,2) (价值评估，可为空)
- maintenance_deadline: DATE (下一次维护截止)
- inventors: JSONB
- related_projects: JSONB
- image_path: VARCHAR(500) (图片路径)
- file_path: VARCHAR(500)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**软件著作权表 (software_copyrights)**
```sql
- id: UUID (主键)
- name: VARCHAR(500)
- registration_number: VARCHAR(100)
- registration_date: DATE
- version: VARCHAR(50)
- status: VARCHAR(20) (申请中/已登记)
- development_language: VARCHAR(50)
- category: VARCHAR(50) (系统软件/应用软件/移动端等)
- latest_update: DATE (最近版本更新时间)
- maintenance_contact: VARCHAR(100)
- developers: JSONB
- image_path: VARCHAR(500)
- file_path: VARCHAR(500)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**项目表 (projects)**
```sql
- id: UUID (主键)
- name: VARCHAR(500)
- project_number: VARCHAR(100)
- project_type: VARCHAR(20) (纵向/横向)
- principal: VARCHAR(100)
- start_date: DATE
- end_date: DATE
- budget: DECIMAL(12,2)
- budget_used: DECIMAL(12,2) (已使用经费)
- status: VARCHAR(20) (申报中/进行中/已结题/暂停)
- progress_percent: INTEGER (0-100)
- priority: VARCHAR(20) (高/中/低)
- risk_level: VARCHAR(20) (高/中/低)
- description: TEXT
- image_path: VARCHAR(500)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**比赛表 (competitions)**
```sql
- id: UUID (主键)
- name: VARCHAR(500)
- level: VARCHAR(20) (国家级/省级/校级)
- award_level: VARCHAR(50)
- award_date: DATE
- registration_deadline: DATE
- submission_deadline: DATE
- progress_percent: INTEGER (赛事准备进度)
- mentor: VARCHAR(100) (指导老师)
- team_members: JSONB
- status: VARCHAR(20) (报名中/进行中/已获奖/已完结)
- image_path: VARCHAR(500)
- file_path: VARCHAR(500)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**会议表 (conferences)**
```sql
- id: UUID (主键)
- name: VARCHAR(500)
- level: VARCHAR(20)
- location: VARCHAR(200)
- start_date: DATE
- end_date: DATE
- participation_type: VARCHAR(20) (参会/报告/组织)
- submission_status: VARCHAR(20) (准备中/已提交/被接受/拒稿)
- travel_budget: DECIMAL(12,2)
- travel_expense: DECIMAL(12,2)
- visa_required: BOOLEAN
- reminder_date: DATE (关键提醒，如注册截止)
- participants: JSONB
- description: TEXT
- image_path: VARCHAR(500)
- file_path: VARCHAR(500)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**合作表 (cooperations)**
```sql
- id: UUID (主键)
- organization: VARCHAR(200)
- content: TEXT
- start_date: DATE
- end_date: DATE
- cooperation_type: VARCHAR(50)
- status: VARCHAR(20) (洽谈中/进行中/已完成/暂停)
- cooperation_value: DECIMAL(12,2) (项目价值)
- pipeline_stage: VARCHAR(50) (意向/评估/合同/执行)
- contact_person: VARCHAR(100)
- contact_email: VARCHAR(100)
- contact_phone: VARCHAR(50)
- next_follow_up: DATE
- image_path: VARCHAR(500)
- file_path: VARCHAR(500)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**资源表 (resources)**
```sql
- id: UUID (主键)
- name: VARCHAR(500)
- resource_type: VARCHAR(50) (数据集/工具软件/实验设备/标准规范/技术文档/其他)
- description: TEXT
- version: VARCHAR(50)
- maintainer: VARCHAR(100)
- maintenance_cycle_days: INTEGER (维护周期)
- next_maintenance_date: DATE
- license: VARCHAR(100) (许可证类型)
- download_count: INTEGER (下载次数，默认0)
- usage_rate: DECIMAL(5,2) (使用率百分比，0-100)
- image_path: VARCHAR(500)
- file_path: VARCHAR(500) (资源文件路径，可为空)
- external_url: VARCHAR(500) (外部链接，可为空)
- tags: TEXT[] (标签数组)
- is_public: BOOLEAN (是否公开，默认true)
- created_by: UUID (外键 -> users)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**关联关系表 (relationships)**
```sql
- id: UUID (主键)
- source_type: VARCHAR(50) (paper/patent/project/resource等)
- source_id: UUID
- target_type: VARCHAR(50)
- target_id: UUID
- relationship_type: VARCHAR(50) (related_to/cites/cooperates_with/uses等)
- created_at: TIMESTAMP
```

**资源成果关联表 (resource_achievements)**
```sql
- id: UUID (主键)
- resource_id: UUID (外键 -> resources)
- achievement_type: VARCHAR(50) (paper/patent/project等)
- achievement_id: UUID
- relationship_type: VARCHAR(50) (used_in/related_to等)
- created_at: TIMESTAMP
- PRIMARY KEY (resource_id, achievement_type, achievement_id)
```

**标签表 (tags)**
```sql
- id: UUID (主键)
- name: VARCHAR(100) (唯一)
- color: VARCHAR(20)
- created_at: TIMESTAMP
```

**成果标签关联表 (achievement_tags)**
```sql
- achievement_type: VARCHAR(50)
- achievement_id: UUID
- tag_id: UUID (外键 -> tags)
- PRIMARY KEY (achievement_type, achievement_id, tag_id)
```

**作者贡献度表 (paper_authors)**
```sql
- id: UUID (主键)
- paper_id: UUID (外键 -> papers)
- author_id: UUID (外键 -> users 或 scholars)
- author_name: VARCHAR(100)
- affiliation: VARCHAR(200)
- contribution_level: INTEGER (贡献度百分比)
- order_index: INTEGER (作者排序)
- created_at: TIMESTAMP
```

**项目里程碑表 (project_milestones)**
```sql
- id: UUID (主键)
- project_id: UUID (外键 -> projects)
- name: VARCHAR(200)
- description: TEXT
- due_date: DATE
- status: VARCHAR(20) (未开始/进行中/已完成/延期)
- completion_percent: INTEGER
- responsible_person: VARCHAR(100)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**提醒任务表 (reminders)**
```sql
- id: UUID (主键)
- related_type: VARCHAR(50) (patent/project/resource/conference等)
- related_id: UUID
- title: VARCHAR(200)
- description: TEXT
- reminder_date: DATE
- priority: VARCHAR(20) (高/中/低)
- status: VARCHAR(20) (未开始/进行中/已完成)
- created_by: UUID
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**资源使用记录表 (resource_usage_logs)**
```sql
- id: UUID (主键)
- resource_id: UUID (外键 -> resources)
- user_id: UUID (外键 -> users)
- usage_type: VARCHAR(50) (下载/借用/引用等)
- quantity: INTEGER
- duration_hours: INTEGER (使用时长，可为空)
- usage_date: TIMESTAMP
- notes: TEXT
```

**资源维护计划表 (resource_maintenance_tasks)**
```sql
- id: UUID (主键)
- resource_id: UUID (外键 -> resources)
- task_name: VARCHAR(200)
- scheduled_date: DATE
- assignee: VARCHAR(100)
- status: VARCHAR(20) (待执行/进行中/已完成)
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

**保存的检索视图表 (search_saved_views)**
```sql
- id: UUID (主键)
- user_id: UUID (外键 -> users)
- name: VARCHAR(100)
- description: TEXT
- filters: JSONB (保存的筛选条件)
- created_at: TIMESTAMP
- last_used_at: TIMESTAMP
```

> 以上扩展表结构用于支撑前端的作者贡献榜、项目进度、提醒事项、资源使用率、保存视图等交互模块，可按阶段逐步落地。

#### 3.4.2 Neo4j（知识图谱数据库）
存储实体和关系数据，用于知识图谱构建：

**节点类型 (Node Labels)**
- `Person`：人员
- `Paper`：论文
- `Patent`：专利
- `Project`：项目
- `Organization`：机构
- `Keyword`：关键词
- `Conference`：会议
- `Competition`：比赛
- `Resource`：资源（数据集、工具等）

**关系类型 (Relationship Types)**
- `AUTHORED`：作者关系 (Person)-[:AUTHORED]->(Paper)
- `CITES`：引用关系 (Paper)-[:CITES]->(Paper)
- `RELATED_TO`：关联关系
- `COOPERATES_WITH`：合作关系
- `PARTICIPATED_IN`：参与关系
- `BELONGS_TO`：属于关系
- `HAS_KEYWORD`：关键词关系
- `USES`：使用关系 (Project)-[:USES]->(Resource)
- `BASED_ON`：基于关系 (Paper)-[:BASED_ON]->(Resource)

**节点属性示例**
```cypher
(:Paper {
  id: "uuid",
  title: "论文标题",
  publishDate: "2024-01-01",
  journal: "期刊名称"
})
```

#### 3.4.3 MongoDB（文档数据库）
存储非结构化数据和文件元数据：

**集合 (Collections)**
- `files`：文件元数据
- `search_history`：搜索历史
- `user_preferences`：用户偏好设置
- `notifications`：通知消息

**文档结构示例 (files)**
```json
{
  "_id": ObjectId,
  "file_name": "example.pdf",
  "file_path": "/uploads/papers/xxx.pdf",
  "file_type": "application/pdf",
  "file_size": 1024000,
  "uploaded_by": "user_id",
  "uploaded_at": ISODate,
  "related_achievement_type": "paper",
  "related_achievement_id": "uuid",
  "metadata": {
    "pages": 10,
    "title": "文档标题"
  }
}
```

#### 3.4.4 Redis（缓存数据库）
- **缓存**：热点数据缓存、搜索结果缓存
- **会话存储**：用户会话信息
- **任务队列**：异步任务队列（可选）
- **限流**：API限流控制

**Key命名规范**
- `cache:paper:{id}`：论文缓存
- `session:{session_id}`：会话信息
- `search:history:{user_id}`：搜索历史
- `rate_limit:{user_id}`：限流计数

### 3.5 知识图谱实现方案

#### 3.5.1 数据抽取
1. **实体抽取**
   - 从PostgreSQL中提取实体（论文、专利、项目等）
   - 使用NLP技术提取人员、机构、关键词等实体
   - 实体去重和标准化

2. **关系抽取**
   - 从结构化数据中提取显式关系（作者关系、关联关系）
   - 使用文本分析提取隐式关系（引用关系、合作关系）
   - 关系置信度评分

#### 3.5.2 图谱构建
1. **数据同步**
   - 定期从PostgreSQL同步数据到Neo4j
   - 增量更新机制
   - 数据一致性保证

2. **图谱更新**
   - 实时更新：新数据添加时立即更新图谱
   - 批量更新：定时批量更新图谱
   - 版本管理：图谱版本控制

#### 3.5.3 图谱可视化
1. **前端可视化**
   - 使用D3.js或Cytoscape.js进行图谱渲染
   - 支持缩放、拖拽、节点选择等交互
   - 节点和边的样式自定义

2. **图谱布局算法**
   - Force-directed layout（力导向布局）
   - Hierarchical layout（层次布局）
   - Circular layout（环形布局）

3. **交互功能**
   - 节点点击：显示详细信息
   - 节点搜索：快速定位节点
   - 路径查询：查找两个节点之间的路径
   - 子图提取：提取特定子图

#### 3.5.4 图谱搜索
1. **实体搜索**
   - 根据关键词搜索实体
   - 实体类型过滤
   - 实体属性搜索

2. **关系查询**
   - 查询特定关系
   - 多跳关系查询
   - 关系路径分析

3. **图谱分析**
   - 中心度分析（度中心度、接近中心度、介数中心度）
   - 社区发现
   - 影响力分析

## 4. API设计

### 4.1 认证授权API
```
POST   /api/auth/login          # 用户登录
POST   /api/auth/logout         # 用户登出
POST   /api/auth/refresh        # 刷新令牌
GET    /api/auth/me             # 获取当前用户信息
```

### 4.2 成果管理API
```
# 论文
GET    /api/papers              # 获取论文列表
GET    /api/papers/{id}         # 获取论文详情
POST   /api/papers              # 创建论文
PUT    /api/papers/{id}         # 更新论文
DELETE /api/papers/{id}         # 删除论文
POST   /api/papers/{id}/image   # 上传论文图片

# 专利
GET    /api/patents             # 获取专利列表
GET    /api/patents/{id}        # 获取专利详情
POST   /api/patents             # 创建专利
PUT    /api/patents/{id}        # 更新专利
DELETE /api/patents/{id}        # 删除专利
POST   /api/patents/{id}/image  # 上传专利图片

# 软件著作权
GET    /api/software-copyrights # 获取软著列表
GET    /api/software-copyrights/{id}  # 获取软著详情
POST   /api/software-copyrights       # 创建软著
PUT    /api/software-copyrights/{id}  # 更新软著
DELETE /api/software-copyrights/{id}  # 删除软著
POST   /api/software-copyrights/{id}/image  # 上传软著图片

# 项目
GET    /api/projects            # 获取项目列表
GET    /api/projects/{id}       # 获取项目详情
POST   /api/projects            # 创建项目
PUT    /api/projects/{id}       # 更新项目
DELETE /api/projects/{id}       # 删除项目
POST   /api/projects/{id}/image # 上传项目图片

# 比赛
GET    /api/competitions        # 获取比赛列表
GET    /api/competitions/{id}   # 获取比赛详情
POST   /api/competitions        # 创建比赛
PUT    /api/competitions/{id}   # 更新比赛
DELETE /api/competitions/{id}   # 删除比赛
POST   /api/competitions/{id}/image  # 上传比赛图片

# 会议
GET    /api/conferences         # 获取会议列表
GET    /api/conferences/{id}    # 获取会议详情
POST   /api/conferences         # 创建会议
PUT    /api/conferences/{id}    # 更新会议
DELETE /api/conferences/{id}    # 删除会议
POST   /api/conferences/{id}/image   # 上传会议图片

# 合作
GET    /api/cooperations        # 获取合作列表
GET    /api/cooperations/{id}   # 获取合作详情
POST   /api/cooperations        # 创建合作
PUT    /api/cooperations/{id}   # 更新合作
DELETE /api/cooperations/{id}   # 删除合作
POST   /api/cooperations/{id}/image  # 上传合作图片
```

### 4.3 搜索API
```
GET    /api/search              # 全文搜索
GET    /api/search/advanced     # 高级搜索
GET    /api/search/suggestions  # 搜索建议
GET    /api/search/history      # 搜索历史
```

### 4.4 知识图谱API
```
GET    /api/knowledge-graph/entities        # 获取实体列表
GET    /api/knowledge-graph/entities/{id}   # 获取实体详情
GET    /api/knowledge-graph/relationships   # 获取关系列表
GET    /api/knowledge-graph/path            # 查询路径
GET    /api/knowledge-graph/subgraph        # 获取子图
POST   /api/knowledge-graph/analyze         # 图谱分析
```

### 4.5 统计分析API
```
GET    /api/statistics/overview             # 数据概览
GET    /api/statistics/trend                # 趋势分析
GET    /api/statistics/comparison           # 对比分析
GET    /api/statistics/report               # 生成报表
```

### 4.6 文件管理API
```
POST   /api/files/upload                    # 上传文件
GET    /api/files/{id}                      # 获取文件信息
GET    /api/files/{id}/download             # 下载文件
GET    /api/files/{id}/preview              # 预览文件
DELETE /api/files/{id}                      # 删除文件
```

### 4.7 数据导入导出API
```
POST   /api/import                          # 导入数据
GET    /api/export                          # 导出数据
GET    /api/import/template                 # 获取导入模板
```

### 4.8 资源管理API
```
GET    /api/resources                       # 获取资源列表
GET    /api/resources/{id}                  # 获取资源详情
POST   /api/resources                       # 创建资源
PUT    /api/resources/{id}                  # 更新资源
DELETE /api/resources/{id}                  # 删除资源
POST   /api/resources/{id}/image            # 上传资源图片
POST   /api/resources/{id}/file             # 上传资源文件
GET    /api/resources/{id}/download         # 下载资源文件
GET    /api/resources/types                 # 获取资源类型列表
POST   /api/resources/{id}/associate        # 关联成果
DELETE /api/resources/{id}/associate        # 取消关联成果
GET    /api/resources/{id}/achievements     # 获取关联的成果列表
```

## 5. 前端页面设计

### 5.1 页面路由结构（Next.js App Router 实际实现）
```
/(auth)/auth                # 登录/注册沉浸式落地页（3D 背景）
/(auth)/login               # 登录模式，基于 AuthPage 共享状态
/(auth)/register            # 注册模式
/(dashboard)                # 仪表盘主布局（含 Sidebar、TopNav）
  /(dashboard)/page         # 科研成果概览首页
  /(dashboard)/analytics    # 统计分析页，支持 Tabs 与日期筛选
  /(dashboard)/settings     # 设置中心（账号/安全/偏好/通知/隐私）
```

- 其余业务路由（成果管理、资源、知识图谱等）预留在布局结构中，待与后端接口联通后按需扩展。

### 5.2 登录/注册体验
- **视觉与动效**：`@react-three/fiber` + `@react-three/drei` 构建动态方块场景，覆盖模糊背景图（`/public/images/login-bg*.png`），中文标题使用 `Long Cang`，英文字统一 `Great Vibes`，保证 `/auth`、`/login` 字体一致。
- **路由与状态**：`AuthPage` 通过 `useRouter`、`usePathname` 在 login/register 间切换，同时维护浏览器历史记录；关闭弹窗时回落到 `/auth`。
- **表单交互**：`AuthOverlay` 采用弹窗布局，区分登录与注册字段（注册包含姓名、确认密码），提供忘记密码占位链接与社交登录按钮，支持键盘可达性。

### 5.3 仪表盘首页信息架构（`/(dashboard)/page` 对应截图）
- **侧边栏导航**：`Sidebar` 列出首页、统计分析、论文、专利、软件著作权、项目、比赛、会议、合作、资源管理、搜索、知识图谱等入口，后续可基于角色裁剪。
- **顶部导航 `TopNav`**：展示系统 Logo、面包屑（Home）、主题切换、通知中心、用户头像快捷菜单。
- **指标卡片 `ResearchOverview`**：使用 `lucide-react` 图标及主题色展示论文、专利、软著、项目、比赛、会议、合作、资源八类关键指标。
- **成果趋势 `TrendChart`**：基于 Recharts 折线图展示不同成果类型按月走势。
- **成果统计 `AchievementStats`**：多进度条展示各类成果目标完成度与总体完成率。
- **最新成果 `RecentAchievements`**：展示近期成果动态（当前为示例数据，预留与后端联通）。

### 5.4 核心组件与上下文
- **Layout 体系**：`app/layout.tsx` 提供全局 Provider，`app/(dashboard)/layout.tsx` 负责业务布局。
- **ThemeProvider / SettingsProvider**：分别管理主题、系统设置状态。
- **Sidebar / TopNav**：主导航组件。
- **ResearchOverview / TrendChart / AchievementStats / RecentAchievements**：仪表盘核心可视化组件。
- **DateRangePicker、Tabs、ReportsTab 等**：统计分析页复用的 UI 组件集合。

## 6. 部署方案

### 6.1 开发环境
- **前端**：Next.js dev server（`pnpm dev`，默认 http://localhost:3000）
- **后端**：Uvicorn (localhost:8000)
- **数据库**：Docker Compose部署

### 6.2 生产环境
- **前端**：Nginx静态文件服务
- **后端**：Gunicorn + Uvicorn workers
- **数据库**：独立服务器或云服务
- **文件存储**：对象存储服务
- **反向代理**：Nginx

### 6.3 Docker部署
使用Docker Compose编排所有服务：
- PostgreSQL容器
- Neo4j容器
- MongoDB容器
- Redis容器
- FastAPI应用容器
- Nginx容器

## 7. 安全考虑

### 7.1 认证安全
- JWT令牌过期机制
- 密码加密存储（bcrypt）
- 登录失败次数限制
- 会话管理

### 7.2 数据安全
- SQL注入防护（ORM参数化查询）
- XSS防护（输入验证和输出转义）
- CSRF防护
- 文件上传安全（文件类型验证、大小限制）

### 7.3 访问控制
- 基于角色的访问控制（RBAC）
- API权限验证
- 文件访问权限控制

### 7.4 数据备份
- 定期数据库备份
- 文件备份
- 备份数据加密

## 8. 性能优化

### 8.1 前端优化
- 代码分割和懒加载
- 图片懒加载和压缩
- 图片CDN加速
- 缩略图技术（大图显示缩略图，点击查看原图）
- 虚拟滚动（大数据列表）
- 缓存策略

### 8.2 后端优化
- 数据库索引优化
- 查询优化（N+1问题解决）
- Redis缓存热点数据
- 异步任务处理

### 8.3 搜索优化
- 搜索索引优化
- 搜索结果缓存
- 分页加载

### 8.4 图谱优化
- 图谱数据缓存
- 子图预加载
- 可视化性能优化（节点数量限制）

## 9. 开发计划

### 9.1 第一阶段（基础功能）
- [ ] 项目初始化和环境搭建
- [ ] 数据库设计和创建
- [ ] 用户认证系统
- [ ] 基础CRUD功能（论文、专利等）
- [ ] 前端基础页面

### 9.2 第二阶段（核心功能）
- [ ] 搜索功能实现
- [ ] 知识图谱数据抽取和构建
- [ ] 知识图谱可视化
- [ ] 文件上传和管理
- [ ] 数据导入导出

### 9.3 第三阶段（增强功能）
- [ ] 统计分析功能
- [ ] 数据可视化图表
- [ ] 通知提醒功能
- [ ] 权限管理完善

### 9.4 第四阶段（优化和测试）
- [ ] 性能优化
- [ ] 安全加固
- [ ] 单元测试和集成测试
- [ ] 文档完善

## 10. 技术难点与解决方案

### 10.1 知识图谱构建
**难点**：如何从非结构化文本中抽取实体和关系
**解决方案**：
- 使用规则匹配提取显式关系
- 使用NLP库（spaCy、NLTK）进行实体识别
- 对于复杂场景，可考虑使用预训练模型（BERT等）

### 10.2 图谱可视化性能
**难点**：大量节点和边的渲染性能问题
**解决方案**：
- 使用WebGL加速渲染
- 实现节点聚合（clustering）
- 按需加载子图
- 使用Canvas替代SVG（性能更好）

### 10.3 数据一致性
**难点**：多个数据库之间的数据一致性
**解决方案**：
- 使用事务保证关键操作的一致性
- 实现数据同步机制
- 定期数据校验和修复

### 10.4 搜索性能
**难点**：全文搜索的性能和准确性
**解决方案**：
- 使用PostgreSQL全文搜索或Elasticsearch
- 建立合适的索引
- 搜索结果缓存
- 搜索算法优化

## 11. 扩展性考虑

### 11.1 功能扩展
- 支持更多成果类型
- 支持自定义字段
- 支持多语言
- 支持移动端

### 11.2 技术扩展
- 微服务架构改造
- 引入消息队列（RabbitMQ/Kafka）
- 引入搜索引擎（Elasticsearch）
- 引入机器学习（推荐系统、智能分析）

### 11.3 文档与样式清理
- `code/styles/globals.css`、`code/styles/scrollbar-hide.css`：Next.js 应用已不再使用，可在确认无引用后删除。
- `code/components/layout.tsx`：遗留的旧版布局组件，新布局位于 `app/(dashboard)/layout.tsx`，可移除避免混淆。
- `show_platform/`：Vite 原型项目，如后续仅维护 Next.js 版本，建议归档或移出主仓库。
- Tailwind 配置中的 `./src/**/*` 扫描路径在当前项目结构下无实际文件，可在清理后同步更新 `tailwind.config.js`。

## 12. 总结

本系统设计涵盖了科研成果管理的各个方面，采用现代化的技术栈，支持多种数据类型的统一管理，并通过知识图谱实现数据关联关系的可视化。系统具有良好的扩展性和可维护性，能够满足科研小组的长期使用需求。

### 关键技术选型总结
- **前端**：Next.js + React + TypeScript + Tailwind CSS + Recharts
- **后端**：FastAPI + Python
- **数据库**：PostgreSQL（主库）+ Neo4j（图谱）+ MongoDB（文档）+ Redis（缓存）
- **部署**：Docker + Nginx

### 核心特性
1. 多类型成果统一管理（支持图片展示）
2. 资源管理模块（数据集、工具软件等）
3. 强大的搜索功能
4. 交互式知识图谱
5. 数据统计分析
6. 完善的权限管理
7. 数据导入导出
8. 图片管理与优化

---

**文档版本**：v1.1  
**最后更新**：2024年  
**更新内容**：
- 为所有成果类型添加图片字段支持
- 新增"我们的资源"管理模块
- 完善资源相关的数据库设计、API设计和前端页面设计
- 更新知识图谱节点和关系类型

**作者**：系统设计团队

